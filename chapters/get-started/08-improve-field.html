

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Make the Field Configurable &mdash; Erbsland Configuration Language Parser for C++ 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/erbsland-ansi/ansi.css?v=76679ccf" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=cba98b8c" />
      <link rel="stylesheet" type="text/css" href="../../_static/ansi.css" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f281be69"></script>
      <script src="../../_static/design-tabs.js?v=f930bc37"></script>
      <script src="https://erbsland.dev/ext/fa7/js/all.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Using Value Lists" href="09-using-value-lists.html" />
    <link rel="prev" title="Compile and Run Our Game" href="07-compile-and-run.html" /> 
</head>

<body class="wy-body-for-nav">

 

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Erbsland Configuration Language Parser for C++
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01-project-structure.html">The Project Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-cmake-configuration.html">The CMake Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-write-minimal-main.html">Write a Minimal Main Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-compile-and-run.html">Compile and Run the Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-provoking-errors.html">Provoking Some Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-initial-game-logic.html">Write an Initial Game Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="07-compile-and-run.html">Compile and Run Our Game</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Make the Field Configurable</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#updates-to-the-game-framework">Updates to the Game Framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#extending-the-geometry-classes">Extending the Geometry Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#minor-update-to-the-canvas">Minor Update to the Canvas</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adding-rooms-to-the-field">Adding Rooms to the Field</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reading-the-section-list-from-the-configuration">Reading the Section List from the Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compile-and-run-the-updated-game">Compile and Run the Updated Game</a></li>
<li class="toctree-l3"><a class="reference internal" href="#recap">Recap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="09-using-value-lists.html">Using Value Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="10-the-next-steps.html">The Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/index.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">Contributing Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../goals.html">Goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Erbsland Configuration Language Parser for C++</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Getting Started</a></li>
      <li class="breadcrumb-item active">Make the Field Configurable</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/chapters/get-started/08-improve-field.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="make-the-field-configurable">
<h1>Make the Field Configurable<a class="headerlink" href="#make-the-field-configurable" title="Link to this heading"></a></h1>
<p>So far, the game field has been a simple rectangle. That works—but it’s a bit too predictable. There’s nowhere to hide, and the game feels linear.</p>
<p>Let’s fix that by making the field configurable.</p>
<p>A simple way to add variety is by introducing <strong>rooms</strong>—rectangular sections that make up the walkable areas of the map. These rooms are defined in the configuration and merged into the playfield to build more interesting layouts.</p>
<p>We use a <em>section list</em> in the configuration to define individual rooms:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">configuration.elcl</span><a class="headerlink" href="#id1" title="Link to this code"></a></div>
<div class="highlight-erbsland-conf notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="p">*[</span><span class="na">field</span><span class="p">.</span><span class="na">room</span><span class="p">]</span>
<span class="linenos"> 2</span><span class="na">x</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span>
<span class="linenos"> 3</span><span class="na">y</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span>
<span class="linenos"> 4</span><span class="na">width</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span>
<span class="linenos"> 5</span><span class="na">height</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="p">*[</span><span class="na">field</span><span class="p">.</span><span class="na">room</span><span class="p">]</span>
<span class="linenos"> 8</span><span class="na">x</span><span class="o">:</span><span class="w"> </span><span class="mi">16</span>
<span class="linenos"> 9</span><span class="na">y</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span>
<span class="linenos">10</span><span class="na">width</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span>
<span class="linenos">11</span><span class="na">height</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="p">*[</span><span class="na">field</span><span class="p">.</span><span class="na">room</span><span class="p">]</span>
<span class="linenos">14</span><span class="na">x</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span>
<span class="linenos">15</span><span class="na">y</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span>
<span class="linenos">16</span><span class="na">width</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span>
<span class="linenos">17</span><span class="na">height</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span>
</pre></div>
</div>
</div>
<section id="updates-to-the-game-framework">
<h2>Updates to the Game Framework<a class="headerlink" href="#updates-to-the-game-framework" title="Link to this heading"></a></h2>
<section id="extending-the-geometry-classes">
<h3>Extending the Geometry Classes<a class="headerlink" href="#extending-the-geometry-classes" title="Link to this heading"></a></h3>
<p>First, we expand our geometry module with a new <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code> class, which encapsulates the size and position of a room in a single value. We also add a few helper methods to simplify merging rooms and checking which tiles are inside or outside of a rectangle.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 code-dropdown">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Changes in <code class="file docutils literal notranslate"><span class="pre">robot-escape/src/Geometry.hpp</span></code></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">#pragma once</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;functional&gt;</span>
<span class="linenos"> 4</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;array&gt;</span>
<span class="linenos"> 5</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;random&gt;</span>
<span class="linenos"> 6</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;thread&gt;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="kr">inline</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">randomInt</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">minimum</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maximum</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="k">thread_local</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">mt19937</span><span class="w"> </span><span class="nf">rng</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">random_device</span><span class="p">{}());</span>
<span class="linenos">10</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">uniform_int_distribution</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">{</span><span class="n">minimum</span><span class="p">,</span><span class="w"> </span><span class="n">maximum</span><span class="p">}(</span><span class="n">rng</span><span class="p">);</span>
<span class="linenos">11</span><span class="p">}</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="k">struct</span><span class="w"> </span><span class="nc">Position</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">14</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">{};</span>
<span class="linenos">15</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">{};</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="w">    </span><span class="n">Position</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="linenos">18</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="n">Position</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="p">{</span><span class="n">x</span><span class="p">},</span><span class="w"> </span><span class="n">y</span><span class="p">{</span><span class="n">y</span><span class="p">}</span><span class="w"> </span><span class="p">{}</span>
<span class="linenos">19</span><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="o">&amp;</span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="linenos">20</span><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="k">operator</span><span class="o">!=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="o">&amp;</span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="linenos">21</span><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="k">operator</span><span class="o">+</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="o">&amp;</span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">y</span><span class="p">};</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">22</span><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="k">operator</span><span class="o">-</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="o">&amp;</span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">y</span><span class="p">};</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">23</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">distanceTo</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">24</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
<span class="linenos">25</span><span class="w">    </span><span class="p">}</span>
<span class="hll"><span class="linenos">26</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">componentMax</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">27</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">y</span><span class="p">)};</span>
</span><span class="hll"><span class="linenos">28</span><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="linenos">29</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">componentMin</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">30</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">y</span><span class="p">)};</span>
</span><span class="hll"><span class="linenos">31</span><span class="w">    </span><span class="p">}</span>
</span><span class="linenos">32</span><span class="p">};</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="k">constexpr</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">Position</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cPosDelta4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">35</span><span class="w">    </span><span class="p">{{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">}}};</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="k">struct</span><span class="w"> </span><span class="nc">Size</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">38</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">width</span><span class="p">{};</span>
<span class="linenos">39</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">height</span><span class="p">{};</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="w">    </span><span class="n">Size</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="linenos">42</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="n">Size</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">width</span><span class="p">{</span><span class="n">width</span><span class="p">},</span><span class="w"> </span><span class="n">height</span><span class="p">{</span><span class="n">height</span><span class="p">}</span><span class="w"> </span><span class="p">{}</span>
<span class="hll"><span class="linenos">43</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="n">Size</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">pos1</span><span class="p">,</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="n">pos2</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">width</span><span class="p">{</span><span class="n">pos2</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pos1</span><span class="p">.</span><span class="n">x</span><span class="p">},</span><span class="w"> </span><span class="n">height</span><span class="p">{</span><span class="n">pos2</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pos1</span><span class="p">.</span><span class="n">y</span><span class="p">}</span><span class="w"> </span><span class="p">{}</span>
</span><span class="linenos">44</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">fitsInto</span><span class="p">(</span><span class="n">Size</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">45</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">height</span><span class="p">;</span>
<span class="linenos">46</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">47</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">area</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">height</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">48</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">center</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">49</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="n">width</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">};</span>
<span class="linenos">50</span><span class="w">    </span><span class="p">}</span>
<span class="hll"><span class="linenos">51</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">componentMax</span><span class="p">(</span><span class="n">Size</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Size</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">52</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">width</span><span class="p">),</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">height</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">height</span><span class="p">)};</span>
</span><span class="hll"><span class="linenos">53</span><span class="w">    </span><span class="p">}</span>
</span><span class="linenos">54</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Position</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">55</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">height</span><span class="p">;</span>
<span class="linenos">56</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">57</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Position</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">58</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
<span class="linenos">59</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">60</span><span class="p">};</span>
<span class="linenos">61</span>
<span class="hll"><span class="linenos">62</span><span class="k">struct</span><span class="w"> </span><span class="nc">Rectangle</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">63</span><span class="w">    </span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">{};</span>
</span><span class="hll"><span class="linenos">64</span><span class="w">    </span><span class="n">Size</span><span class="w"> </span><span class="n">size</span><span class="p">{};</span>
</span><span class="hll"><span class="linenos">65</span>
</span><span class="hll"><span class="linenos">66</span><span class="w">    </span><span class="n">Rectangle</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
</span><span class="hll"><span class="linenos">67</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="n">Rectangle</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">pos</span><span class="p">{</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">},</span><span class="w"> </span><span class="n">size</span><span class="p">{</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">}</span><span class="w"> </span><span class="p">{}</span>
</span><span class="hll"><span class="linenos">68</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="n">Rectangle</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">Size</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">pos</span><span class="p">{</span><span class="n">pos</span><span class="p">},</span><span class="w"> </span><span class="n">size</span><span class="p">{</span><span class="n">size</span><span class="p">}</span><span class="w"> </span><span class="p">{}</span>
</span><span class="hll"><span class="linenos">69</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">x2</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span class="hll"><span class="linenos">70</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">y2</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span class="hll"><span class="linenos">71</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">bottomRight</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="n">x2</span><span class="p">(),</span><span class="w"> </span><span class="n">y2</span><span class="p">()};</span><span class="w"> </span><span class="p">}</span>
</span><span class="hll"><span class="linenos">72</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">center</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">73</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">y</span><span class="p">};</span>
</span><span class="hll"><span class="linenos">74</span><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="linenos">75</span><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="k">operator</span><span class="o">|=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Rectangle</span><span class="w"> </span><span class="o">&amp;</span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Rectangle</span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">76</span><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">newPos1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">componentMin</span><span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">pos</span><span class="p">);</span>
</span><span class="hll"><span class="linenos">77</span><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">newPos2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bottomRight</span><span class="p">().</span><span class="n">componentMax</span><span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">bottomRight</span><span class="p">());</span>
</span><span class="hll"><span class="linenos">78</span><span class="w">        </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newPos1</span><span class="p">;</span>
</span><span class="hll"><span class="linenos">79</span><span class="w">        </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Size</span><span class="p">{</span><span class="n">newPos1</span><span class="p">,</span><span class="w"> </span><span class="n">newPos2</span><span class="p">};</span>
</span><span class="hll"><span class="linenos">80</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span>
</span><span class="hll"><span class="linenos">81</span><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="linenos">82</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">padded</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">paddingX</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">paddingY</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Rectangle</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">83</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Rectangle</span><span class="p">{</span><span class="n">pos</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">paddingX</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">paddingY</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">paddingX</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">paddingY</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">};</span>
</span><span class="hll"><span class="linenos">84</span><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="linenos">85</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Position</span><span class="o">&amp;</span><span class="w"> </span><span class="n">testedPosition</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">86</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">testedPosition</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">testedPosition</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">pos</span><span class="p">.</span><span class="n">y</span>
</span><span class="hll"><span class="linenos">87</span><span class="w">            </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">testedPosition</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">x2</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">testedPosition</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">y2</span><span class="p">();</span>
</span><span class="hll"><span class="linenos">88</span><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="linenos">89</span><span class="w">    </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Fn</span><span class="o">&gt;</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">forEach</span><span class="p">(</span><span class="n">Fn</span><span class="w"> </span><span class="n">fn</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">90</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">91</span><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">92</span><span class="w">                </span><span class="n">fn</span><span class="p">(</span><span class="n">Position</span><span class="p">{</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">}</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pos</span><span class="p">);</span>
</span><span class="hll"><span class="linenos">93</span><span class="w">            </span><span class="p">}</span>
</span><span class="hll"><span class="linenos">94</span><span class="w">        </span><span class="p">}</span>
</span><span class="hll"><span class="linenos">95</span><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="linenos">96</span><span class="p">};</span>
</span></pre></div>
</div>
</div>
</details><p><a class="reference download internal" download="" href="../../_downloads/2971c6d9c164c31863bf5c2e1926d0c8/Geometry.hpp"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">the</span> <span class="pre">updated</span> <span class="pre">Geometry.hpp</span></code></a></p>
</section>
<section id="minor-update-to-the-canvas">
<h3>Minor Update to the Canvas<a class="headerlink" href="#minor-update-to-the-canvas" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Canvas</span></code> now uses the new <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code> class to render room shapes.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 code-dropdown">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Changes in <code class="file docutils literal notranslate"><span class="pre">robot-escape/src/Canvas.hpp</span></code></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">#pragma once</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Geometry.hpp&quot;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>
<span class="linenos"> 6</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="linenos"> 7</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;numeric&gt;</span>
<span class="linenos"> 8</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ranges&gt;</span>
<span class="linenos"> 9</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;algorithm&gt;</span>
<span class="linenos">10</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdint&gt;</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Block</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">13</span><span class="w">    </span><span class="n">Empty</span><span class="p">,</span>
<span class="linenos">14</span><span class="w">    </span><span class="n">Wall</span><span class="p">,</span>
<span class="linenos">15</span><span class="w">    </span><span class="n">Room</span><span class="p">,</span>
<span class="linenos">16</span><span class="w">    </span><span class="n">Exit</span><span class="p">,</span>
<span class="linenos">17</span><span class="w">    </span><span class="n">Player</span><span class="p">,</span>
<span class="linenos">18</span><span class="w">    </span><span class="n">PlayerTrail</span><span class="p">,</span>
<span class="linenos">19</span><span class="w">    </span><span class="n">Robot</span><span class="p">,</span>
<span class="linenos">20</span><span class="w">    </span><span class="n">RobotTrail</span><span class="p">,</span>
<span class="linenos">21</span><span class="p">};</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="k">struct</span><span class="w"> </span><span class="nc">Canvas</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">24</span><span class="w">    </span><span class="n">Size</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
<span class="linenos">25</span><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Block</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<span class="linenos">26</span><span class="w">    </span><span class="n">Position</span><span class="w"> </span><span class="n">topLeft</span><span class="p">;</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">cDefaultSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Size</span><span class="p">{</span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">};</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="w">    </span><span class="k">explicit</span><span class="w"> </span><span class="n">Canvas</span><span class="p">(</span><span class="n">Size</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cDefaultSize</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">size</span><span class="p">{</span><span class="n">size</span><span class="p">},</span><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">size</span><span class="p">.</span><span class="n">area</span><span class="p">(),</span><span class="w"> </span><span class="n">Block</span><span class="o">::</span><span class="n">Empty</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="linenos">31</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">setTopLeft</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">topLeft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">32</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">setBlock</span><span class="p">(</span><span class="n">Block</span><span class="w"> </span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">33</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">size</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">topLeft</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">34</span><span class="w">        </span><span class="n">data</span><span class="p">[</span><span class="n">size</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">topLeft</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">block</span><span class="p">;</span>
<span class="linenos">35</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">36</span><span class="w">    </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">PosArgs</span><span class="o">&gt;</span>
<span class="linenos">37</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">setBlocks</span><span class="p">(</span><span class="n">Block</span><span class="w"> </span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="n">PosArgs</span><span class="p">...</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">38</span><span class="w">        </span><span class="p">(</span><span class="n">setBlock</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">),</span><span class="w"> </span><span class="p">...);</span>
<span class="linenos">39</span><span class="w">    </span><span class="p">}</span>
<span class="hll"><span class="linenos">40</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">fillRect</span><span class="p">(</span><span class="n">Rectangle</span><span class="w"> </span><span class="n">rect</span><span class="p">,</span><span class="w"> </span><span class="n">Block</span><span class="w"> </span><span class="n">block</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">41</span><span class="w">        </span><span class="n">rect</span><span class="p">.</span><span class="n">forEach</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">Position</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">setBlock</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
</span><span class="hll"><span class="linenos">42</span><span class="w">    </span><span class="p">}</span>
</span><span class="linenos">43</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">blockAt</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Block</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">44</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">blockFromOrigin</span><span class="p">(</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">topLeft</span><span class="p">);</span>
<span class="linenos">45</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">46</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">blockFromOrigin</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Block</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">47</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">size</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Block</span><span class="o">::</span><span class="n">Empty</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">48</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="n">size</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">pos</span><span class="p">)];</span>
<span class="linenos">49</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">50</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">renderToConsole</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">51</span><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\x1b</span><span class="s">[0m&quot;</span><span class="p">;</span>
<span class="linenos">52</span><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">lastBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Block</span><span class="o">::</span><span class="n">Player</span><span class="p">;</span>
<span class="linenos">53</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">54</span><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">55</span><span class="w">                </span><span class="n">renderBlockAt</span><span class="p">({</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">},</span><span class="w"> </span><span class="n">lastBlock</span><span class="p">);</span>
<span class="linenos">56</span><span class="w">            </span><span class="p">}</span>
<span class="linenos">57</span><span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="linenos">58</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">59</span><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\x1b</span><span class="s">[0m</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="linenos">60</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">61</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">renderBlockAt</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">Block</span><span class="w"> </span><span class="o">&amp;</span><span class="n">lastBlock</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">62</span><span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string_view</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="o">&gt;</span><span class="w"> </span><span class="n">walls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">63</span><span class="w">            </span><span class="s">&quot;■&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;╺&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;╻&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;┏&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;╸&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;━&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;┓&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;┳&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;╹&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;┗&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;┃&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;┣&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;┛&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;┻&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;┫&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;╋&quot;</span>
<span class="linenos">64</span><span class="w">        </span><span class="p">};</span>
<span class="linenos">65</span><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">blockFromOrigin</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>
<span class="linenos">66</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">block</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">lastBlock</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">67</span><span class="w">            </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">block</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">68</span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Empty</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\x1b</span><span class="s">[90m&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">69</span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Wall</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\x1b</span><span class="s">[32m&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">70</span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Room</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\x1b</span><span class="s">[0m&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;;</span>
<span class="linenos">71</span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Exit</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\x1b</span><span class="s">[92m&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">72</span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Player</span><span class="p">:</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">PlayerTrail</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\x1b</span><span class="s">[93m&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">73</span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Robot</span><span class="p">:</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">RobotTrail</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\x1b</span><span class="s">[91m&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">74</span><span class="w">            </span><span class="p">}</span>
<span class="linenos">75</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">76</span><span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">block</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">77</span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Empty</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;░&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">78</span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Wall</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">walls</span><span class="p">[</span><span class="n">matchBlocks4</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">Block</span><span class="o">::</span><span class="n">Wall</span><span class="p">)];</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">79</span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Room</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">80</span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Exit</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;⚑&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">81</span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Player</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;☻&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">82</span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">Robot</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;♟&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">83</span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">PlayerTrail</span><span class="p">:</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="no">Block</span><span class="o">::</span><span class="no">RobotTrail</span><span class="p">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;∙&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="linenos">84</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">85</span><span class="w">        </span><span class="n">lastBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">block</span><span class="p">;</span>
<span class="linenos">86</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">87</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">matchBlocks4</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">Block</span><span class="w"> </span><span class="n">block</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">88</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">accumulate</span><span class="p">(</span><span class="n">cPosDelta4</span><span class="p">.</span><span class="n">rbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">cPosDelta4</span><span class="p">.</span><span class="n">rend</span><span class="p">(),</span><span class="w"> </span><span class="mi">0U</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">acc</span><span class="p">,</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="n">delta</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">89</span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">acc</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">blockFromOrigin</span><span class="p">(</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">90</span><span class="w">        </span><span class="p">});</span>
<span class="linenos">91</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">92</span><span class="p">};</span>
</pre></div>
</div>
</div>
</details><p><a class="reference download internal" download="" href="../../_downloads/4bf36a4d847f7ca4d99b888ea4261ab0/Canvas.hpp"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">the</span> <span class="pre">updated</span> <span class="pre">Canvas.hpp</span></code></a></p>
</section>
<section id="adding-rooms-to-the-field">
<h3>Adding Rooms to the Field<a class="headerlink" href="#adding-rooms-to-the-field" title="Link to this heading"></a></h3>
<p>In <code class="file docutils literal notranslate"><span class="pre">World.hpp</span></code>, we introduce a new class, <code class="docutils literal notranslate"><span class="pre">Room</span></code>, and update the <code class="docutils literal notranslate"><span class="pre">Field</span></code> class so it can build the playfield based on a list of configured rooms.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 code-dropdown">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Changes in <code class="file docutils literal notranslate"><span class="pre">robot-escape/src/World.hpp</span></code></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="cp">#pragma once</span>
<span class="linenos">  2</span>
<span class="linenos">  3</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Geometry.hpp&quot;</span>
<span class="linenos">  4</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Canvas.hpp&quot;</span>
<span class="linenos">  5</span>
<span class="linenos">  6</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ranges&gt;</span>
<span class="linenos">  7</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;algorithm&gt;</span>
<span class="linenos">  8</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span><span class="k">template</span><span class="o">&lt;</span><span class="n">Block</span><span class="w"> </span><span class="n">tElementBlock</span><span class="p">,</span><span class="w"> </span><span class="n">Block</span><span class="w"> </span><span class="n">tTrailBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tElementBlock</span><span class="o">&gt;</span>
<span class="linenos"> 11</span><span class="k">struct</span><span class="w"> </span><span class="nc">ElementWithPos</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 12</span><span class="w">    </span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">{};</span>
<span class="linenos"> 13</span><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Position</span><span class="o">&gt;</span><span class="w"> </span><span class="n">trail</span><span class="p">;</span>
<span class="linenos"> 14</span><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos"> 15</span>
<span class="linenos"> 16</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">moveTo</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">newPos</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 17</span><span class="w">        </span><span class="n">trail</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>
<span class="linenos"> 18</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">trail</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">trail</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">trail</span><span class="p">.</span><span class="n">begin</span><span class="p">());</span><span class="w"> </span><span class="p">}</span>
<span class="linenos"> 19</span><span class="w">        </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newPos</span><span class="p">;</span>
<span class="linenos"> 20</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">Canvas</span><span class="w"> </span><span class="o">&amp;</span><span class="n">canvas</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 23</span><span class="w">        </span><span class="n">canvas</span><span class="p">.</span><span class="n">setBlock</span><span class="p">(</span><span class="n">tElementBlock</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">);</span>
<span class="linenos"> 24</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">trailPos</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">trail</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 25</span><span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">currentBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">canvas</span><span class="p">.</span><span class="n">blockAt</span><span class="p">(</span><span class="n">trailPos</span><span class="p">);</span>
<span class="linenos"> 26</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentBlock</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Block</span><span class="o">::</span><span class="n">Room</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">currentBlock</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Block</span><span class="o">::</span><span class="n">RobotTrail</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">canvas</span><span class="p">.</span><span class="n">setBlock</span><span class="p">(</span><span class="n">tTrailBlock</span><span class="p">,</span><span class="w"> </span><span class="n">trailPos</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<span class="linenos"> 27</span><span class="w">        </span><span class="p">}</span>
<span class="linenos"> 28</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 29</span><span class="p">};</span>
<span class="linenos"> 30</span>
<span class="linenos"> 31</span><span class="k">using</span><span class="w"> </span><span class="n">Player</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ElementWithPos</span><span class="o">&lt;</span><span class="n">Block</span><span class="o">::</span><span class="n">Player</span><span class="p">,</span><span class="w"> </span><span class="n">Block</span><span class="o">::</span><span class="n">PlayerTrail</span><span class="o">&gt;</span><span class="p">;</span>
<span class="linenos"> 32</span><span class="k">using</span><span class="w"> </span><span class="n">Robot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ElementWithPos</span><span class="o">&lt;</span><span class="n">Block</span><span class="o">::</span><span class="n">Robot</span><span class="p">,</span><span class="w"> </span><span class="n">Block</span><span class="o">::</span><span class="n">RobotTrail</span><span class="o">&gt;</span><span class="p">;</span>
<span class="linenos"> 33</span><span class="k">using</span><span class="w"> </span><span class="n">Exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ElementWithPos</span><span class="o">&lt;</span><span class="n">Block</span><span class="o">::</span><span class="n">Exit</span><span class="o">&gt;</span><span class="p">;</span>
<span class="linenos"> 34</span>
<span class="hll"><span class="linenos"> 35</span><span class="k">struct</span><span class="w"> </span><span class="nc">Room</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 36</span><span class="w">    </span><span class="n">Rectangle</span><span class="w"> </span><span class="n">rect</span><span class="p">;</span>
</span><span class="hll"><span class="linenos"> 37</span><span class="p">};</span>
</span><span class="linenos"> 38</span>
<span class="hll"><span class="linenos"> 39</span><span class="k">struct</span><span class="w"> </span><span class="nc">Field</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 40</span><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Room</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rooms</span><span class="p">;</span>
</span><span class="hll"><span class="linenos"> 41</span><span class="w">    </span><span class="n">Rectangle</span><span class="w"> </span><span class="n">rect</span><span class="p">;</span>
</span><span class="hll"><span class="linenos"> 42</span>
</span><span class="hll"><span class="linenos"> 43</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">updatePosAndSize</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 44</span><span class="w">        </span><span class="n">rect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rooms</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">rect</span><span class="p">;</span>
</span><span class="hll"><span class="linenos"> 45</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">rooms</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 46</span><span class="w">            </span><span class="n">rect</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">rooms</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rect</span><span class="p">;</span>
</span><span class="hll"><span class="linenos"> 47</span><span class="w">        </span><span class="p">}</span>
</span><span class="hll"><span class="linenos"> 48</span><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="linenos"> 49</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">addRoom</span><span class="p">(</span><span class="n">Rectangle</span><span class="w"> </span><span class="n">roomRect</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 50</span><span class="w">        </span><span class="n">rooms</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">Room</span><span class="p">{</span><span class="n">roomRect</span><span class="p">});</span>
</span><span class="hll"><span class="linenos"> 51</span><span class="w">        </span><span class="n">updatePosAndSize</span><span class="p">();</span>
</span><span class="hll"><span class="linenos"> 52</span><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="linenos"> 53</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="n">Canvas</span><span class="w"> </span><span class="o">&amp;</span><span class="n">canvas</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 54</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">room</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">rooms</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">canvas</span><span class="p">.</span><span class="n">fillRect</span><span class="p">(</span><span class="n">room</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">padded</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">Block</span><span class="o">::</span><span class="n">Wall</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
</span><span class="hll"><span class="linenos"> 55</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">room</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">rooms</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">canvas</span><span class="p">.</span><span class="n">fillRect</span><span class="p">(</span><span class="n">room</span><span class="p">.</span><span class="n">rect</span><span class="p">,</span><span class="w"> </span><span class="n">Block</span><span class="o">::</span><span class="n">Room</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
</span><span class="hll"><span class="linenos"> 56</span><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="linenos"> 57</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 58</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">ranges</span><span class="o">::</span><span class="n">any_of</span><span class="p">(</span><span class="n">rooms</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">room</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">room</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
</span><span class="hll"><span class="linenos"> 59</span><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="linenos"> 60</span><span class="w">    </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Fn</span><span class="o">&gt;</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">filterPositions</span><span class="p">(</span><span class="n">Fn</span><span class="w"> </span><span class="n">fn</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Position</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 61</span><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Position</span><span class="o">&gt;</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span class="hll"><span class="linenos"> 62</span><span class="w">        </span><span class="n">result</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">area</span><span class="p">());</span>
</span><span class="hll"><span class="linenos"> 63</span><span class="w">        </span><span class="n">rect</span><span class="p">.</span><span class="n">forEach</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">Position</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 64</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">contains</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">fn</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
</span><span class="hll"><span class="linenos"> 65</span><span class="w">        </span><span class="p">});</span>
</span><span class="hll"><span class="linenos"> 66</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span class="hll"><span class="linenos"> 67</span><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="linenos"> 68</span><span class="p">};</span>
</span><span class="linenos"> 69</span>
<span class="linenos"> 70</span><span class="k">struct</span><span class="w"> </span><span class="nc">World</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 71</span><span class="w">    </span><span class="n">Field</span><span class="w"> </span><span class="n">field</span><span class="p">;</span>
<span class="linenos"> 72</span><span class="w">    </span><span class="n">Player</span><span class="w"> </span><span class="n">player</span><span class="p">;</span>
<span class="linenos"> 73</span><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Robot</span><span class="o">&gt;</span><span class="w"> </span><span class="n">robots</span><span class="p">;</span>
<span class="linenos"> 74</span><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Exit</span><span class="o">&gt;</span><span class="w"> </span><span class="n">exits</span><span class="p">;</span>
<span class="linenos"> 75</span>
<span class="hll"><span class="linenos"> 76</span><span class="w">    </span><span class="n">World</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
</span><span class="linenos"> 77</span><span class="w">    </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<span class="linenos"> 78</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">tooNear</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">distance</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">elements</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 79</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">any_of</span><span class="p">(</span><span class="n">elements</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">elements</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">element</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 80</span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">element</span><span class="p">.</span><span class="n">pos</span><span class="p">.</span><span class="n">distanceTo</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">distance</span><span class="p">;</span>
<span class="linenos"> 81</span><span class="w">        </span><span class="p">});</span>
<span class="linenos"> 82</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 83</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">isValidPlayerMovement</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos"> 84</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">field</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>
</span><span class="linenos"> 85</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 86</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">isValidRobotMovement</span><span class="p">(</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos"> 87</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">field</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">tooNear</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">robots</span><span class="p">);</span>
</span><span class="linenos"> 88</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 89</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">isPlayerOnExit</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 90</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">ranges</span><span class="o">::</span><span class="n">any_of</span><span class="p">(</span><span class="n">exits</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">Exit</span><span class="w"> </span><span class="o">&amp;</span><span class="n">exit</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">exit</span><span class="p">.</span><span class="n">pos</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="n">pos</span><span class="p">;</span><span class="w"> </span><span class="p">});</span>
<span class="linenos"> 91</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 92</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">isRobotOnPlayer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 93</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">ranges</span><span class="o">::</span><span class="n">any_of</span><span class="p">(</span><span class="n">robots</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">Robot</span><span class="w"> </span><span class="o">&amp;</span><span class="n">robot</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">robot</span><span class="p">.</span><span class="n">pos</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="n">pos</span><span class="p">;</span><span class="w"> </span><span class="p">});</span>
<span class="linenos"> 94</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 95</span><span class="w">    </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Fn</span><span class="o">&gt;</span>
<span class="linenos"> 96</span><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">randomValidFieldPosition</span><span class="p">(</span><span class="n">Fn</span><span class="w"> </span><span class="n">fn</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos"> 97</span><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">validPositions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">field</span><span class="p">.</span><span class="n">filterPositions</span><span class="p">(</span><span class="n">fn</span><span class="p">);</span>
</span><span class="linenos"> 98</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">validPositions</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 99</span><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">logic_error</span><span class="p">{</span><span class="s">&quot;Could not find a valid position&quot;</span><span class="p">};</span>
<span class="linenos">100</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">101</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">validPositions</span><span class="p">[</span><span class="n">randomInt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">validPositions</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)];</span>
<span class="linenos">102</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">103</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">addExitAtRandomPosition</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">104</span><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Exit</span><span class="p">{</span><span class="n">randomValidFieldPosition</span><span class="p">([](</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">){</span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;})};</span>
<span class="linenos">105</span><span class="w">        </span><span class="n">exits</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">exit</span><span class="p">));</span>
<span class="linenos">106</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">107</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">setPlayerToRandomPosition</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">108</span><span class="w">        </span><span class="n">player</span><span class="p">.</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">randomValidFieldPosition</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">109</span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">tooNear</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">exits</span><span class="p">);</span>
<span class="linenos">110</span><span class="w">        </span><span class="p">});</span>
<span class="linenos">111</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">112</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">addRobotAtRandomPosition</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">113</span><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">robot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Robot</span><span class="p">{</span><span class="n">randomValidFieldPosition</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">Position</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">114</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="n">pos</span><span class="p">.</span><span class="n">distanceTo</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">115</span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">tooNear</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">exits</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">tooNear</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">robots</span><span class="p">);</span>
<span class="linenos">116</span><span class="w">        </span><span class="p">})};</span>
<span class="linenos">117</span><span class="w">        </span><span class="n">robot</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Robot {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">robots</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">118</span><span class="w">        </span><span class="n">robots</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">robot</span><span class="p">));</span>
<span class="linenos">119</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">120</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">render</span><span class="p">(</span><span class="n">Canvas</span><span class="w"> </span><span class="o">&amp;</span><span class="n">canvas</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos">121</span><span class="w">        </span><span class="n">canvas</span><span class="p">.</span><span class="n">setTopLeft</span><span class="p">(</span><span class="n">canvas</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">center</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">field</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">center</span><span class="p">());</span>
</span><span class="linenos">122</span><span class="w">        </span><span class="n">field</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">canvas</span><span class="p">);</span>
<span class="linenos">123</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">exit</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">exits</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">124</span><span class="w">            </span><span class="n">exit</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">canvas</span><span class="p">);</span>
<span class="linenos">125</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">126</span><span class="w">        </span><span class="n">player</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">canvas</span><span class="p">);</span>
<span class="linenos">127</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">robot</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">robots</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">128</span><span class="w">            </span><span class="n">robot</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">canvas</span><span class="p">);</span>
<span class="linenos">129</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">130</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">131</span><span class="p">};</span>
</pre></div>
</div>
</div>
</details><p><a class="reference download internal" download="" href="../../_downloads/2dbbabe7d1e60afd7ad50df3dc0f62ed/World.hpp"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">the</span> <span class="pre">updated</span> <span class="pre">World.hpp</span></code></a></p>
</section>
</section>
<section id="reading-the-section-list-from-the-configuration">
<h2>Reading the Section List from the Configuration<a class="headerlink" href="#reading-the-section-list-from-the-configuration" title="Link to this heading"></a></h2>
<p>Next, let’s look at how we read this list of room definitions from the configuration.</p>
<p>Here’s a quick overview of the updated code in <code class="file docutils literal notranslate"><span class="pre">Application.hpp</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">robot-escape/src/Application.hpp</span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="cp">#pragma once</span>
<span class="linenos">  2</span>
<span class="linenos">  3</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Canvas.hpp&quot;</span>
<span class="linenos">  4</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Logic.hpp&quot;</span>
<span class="linenos">  5</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;World.hpp&quot;</span>
<span class="linenos">  6</span>
<span class="linenos">  7</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;erbsland/all_conf.hpp&gt;</span>
<span class="linenos">  8</span>
<span class="linenos">  9</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;filesystem&gt;</span>
<span class="linenos"> 10</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="linenos"> 11</span>
<span class="linenos"> 12</span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">el</span><span class="o">::</span><span class="nn">conf</span><span class="p">;</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="k">struct</span><span class="w"> </span><span class="nc">Application</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 15</span><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">filesystem</span><span class="o">::</span><span class="n">path</span><span class="w"> </span><span class="n">configPath</span><span class="p">;</span>
<span class="linenos"> 16</span><span class="w">    </span><span class="n">DocumentPtr</span><span class="w"> </span><span class="n">config</span><span class="p">;</span>
<span class="linenos"> 17</span>
<span class="hll"><span class="linenos"> 18</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">cMinimumFieldSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Size</span><span class="p">{</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">};</span>
</span><span class="hll"><span class="linenos"> 19</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">cMaximumFieldSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Size</span><span class="p">{</span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">};</span>
</span><span class="hll"><span class="linenos"> 20</span><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">cMinimumCanvasSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Size</span><span class="p">{</span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">};</span>
</span><span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">parseArgs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 23</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 24</span><span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Usage: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &lt;config-file&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="linenos"> 25</span><span class="w">            </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 26</span><span class="w">        </span><span class="p">}</span>
<span class="linenos"> 27</span><span class="w">        </span><span class="n">configPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">filesystem</span><span class="o">::</span><span class="n">path</span><span class="p">{</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]};</span>
<span class="linenos"> 28</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">readConfiguration</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 31</span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 32</span><span class="w">            </span><span class="n">Parser</span><span class="w"> </span><span class="n">parser</span><span class="p">;</span>
<span class="linenos"> 33</span><span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Source</span><span class="o">::</span><span class="n">fromFile</span><span class="p">(</span><span class="n">configPath</span><span class="p">);</span>
<span class="linenos"> 34</span><span class="w">            </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parser</span><span class="p">.</span><span class="n">parseOrThrow</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
<span class="linenos"> 35</span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="o">&amp;</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 36</span><span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">toText</span><span class="p">().</span><span class="n">toCharString</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="linenos"> 37</span><span class="w">            </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 38</span><span class="w">        </span><span class="p">}</span>
<span class="linenos"> 39</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 40</span>
<span class="linenos"> 41</span><span class="w">    </span><span class="p">[[</span><span class="n">nodiscard</span><span class="p">]]</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">buildWorld</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">World</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos"> 42</span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 43</span><span class="w">            </span><span class="n">World</span><span class="w"> </span><span class="n">world</span><span class="p">;</span>
</span><span class="hll"><span class="linenos"> 44</span><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">roomValue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">config</span><span class="o">-&gt;</span><span class="n">getSectionListOrThrow</span><span class="p">(</span><span class="s">&quot;field.room&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 45</span><span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">roomRect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rectangle</span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 46</span><span class="w">                    </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">roomValue</span><span class="o">-&gt;</span><span class="n">getIntegerOrThrow</span><span class="p">(</span><span class="sa">u8</span><span class="s">&quot;x&quot;</span><span class="p">)),</span>
</span><span class="hll"><span class="linenos"> 47</span><span class="w">                    </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">roomValue</span><span class="o">-&gt;</span><span class="n">getIntegerOrThrow</span><span class="p">(</span><span class="sa">u8</span><span class="s">&quot;y&quot;</span><span class="p">)),</span>
</span><span class="hll"><span class="linenos"> 48</span><span class="w">                    </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">roomValue</span><span class="o">-&gt;</span><span class="n">getIntegerOrThrow</span><span class="p">(</span><span class="sa">u8</span><span class="s">&quot;width&quot;</span><span class="p">)),</span>
</span><span class="hll"><span class="linenos"> 49</span><span class="w">                    </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">roomValue</span><span class="o">-&gt;</span><span class="n">getIntegerOrThrow</span><span class="p">(</span><span class="sa">u8</span><span class="s">&quot;height&quot;</span><span class="p">)),</span>
</span><span class="hll"><span class="linenos"> 50</span><span class="w">                </span><span class="p">};</span>
</span><span class="hll"><span class="linenos"> 51</span><span class="w">                </span><span class="n">world</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">addRoom</span><span class="p">(</span><span class="n">roomRect</span><span class="p">);</span>
</span><span class="hll"><span class="linenos"> 52</span><span class="w">            </span><span class="p">}</span>
</span><span class="hll"><span class="linenos"> 53</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">cMinimumFieldSize</span><span class="p">.</span><span class="n">fitsInto</span><span class="p">(</span><span class="n">world</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 54</span><span class="w">                </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Field size must be at least {}x{}</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cMinimumFieldSize</span><span class="p">.</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">cMinimumFieldSize</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
</span><span class="hll"><span class="linenos"> 55</span><span class="w">                </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class="hll"><span class="linenos"> 56</span><span class="w">            </span><span class="p">}</span>
</span><span class="hll"><span class="linenos"> 57</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">world</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">fitsInto</span><span class="p">(</span><span class="n">cMaximumFieldSize</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos"> 58</span><span class="w">                </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Field size must be at most {}x{}</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cMaximumFieldSize</span><span class="p">.</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">cMaximumFieldSize</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
</span><span class="hll"><span class="linenos"> 59</span><span class="w">                </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class="hll"><span class="linenos"> 60</span><span class="w">            </span><span class="p">}</span>
</span><span class="linenos"> 61</span><span class="w">            </span><span class="n">world</span><span class="p">.</span><span class="n">addExitAtRandomPosition</span><span class="p">();</span>
<span class="linenos"> 62</span><span class="w">            </span><span class="n">world</span><span class="p">.</span><span class="n">setPlayerToRandomPosition</span><span class="p">();</span>
<span class="linenos"> 63</span><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 64</span><span class="w">                </span><span class="n">world</span><span class="p">.</span><span class="n">addRobotAtRandomPosition</span><span class="p">();</span>
<span class="linenos"> 65</span><span class="w">            </span><span class="p">}</span>
<span class="linenos"> 66</span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">world</span><span class="p">;</span>
<span class="linenos"> 67</span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="o">&amp;</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 68</span><span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">toText</span><span class="p">().</span><span class="n">toCharString</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="linenos"> 69</span><span class="w">            </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos"> 70</span><span class="w">        </span><span class="p">}</span>
<span class="linenos"> 71</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 72</span>
<span class="linenos"> 73</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">renderLogic</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Logic</span><span class="w"> </span><span class="o">&amp;</span><span class="n">logic</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos"> 74</span><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">canvasSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logic</span><span class="p">.</span><span class="n">world</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">padded</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">).</span><span class="n">size</span><span class="p">.</span><span class="n">componentMax</span><span class="p">(</span><span class="n">cMinimumCanvasSize</span><span class="p">);</span>
</span><span class="linenos"> 75</span><span class="w">        </span><span class="n">Canvas</span><span class="w"> </span><span class="n">canvas</span><span class="p">{</span><span class="n">canvasSize</span><span class="p">};</span>
<span class="linenos"> 76</span><span class="w">        </span><span class="n">logic</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">canvas</span><span class="p">);</span>
<span class="linenos"> 77</span><span class="w">        </span><span class="n">canvas</span><span class="p">.</span><span class="n">renderToConsole</span><span class="p">();</span>
<span class="linenos"> 78</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 79</span>
<span class="linenos"> 80</span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 81</span><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">initialWorld</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buildWorld</span><span class="p">();</span>
<span class="linenos"> 82</span><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;----------------------------==[ ROBOT ESCAPE ]==-----------------------------</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="linenos"> 83</span><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Welcome to Robot Escape!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="linenos"> 84</span><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;You (☻) must run to the exit (⚑) before any robot (♟) catches you.</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="linenos"> 85</span><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">logic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Logic</span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">initialWorld</span><span class="p">)};</span>
<span class="linenos"> 86</span><span class="w">        </span><span class="n">renderLogic</span><span class="p">(</span><span class="n">logic</span><span class="p">);</span>
<span class="linenos"> 87</span><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logic</span><span class="p">.</span><span class="n">gameState</span><span class="p">();</span>
<span class="linenos"> 88</span><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">GameState</span><span class="o">::</span><span class="n">Running</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 89</span><span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">playerInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputFromConsole</span><span class="p">();</span>
<span class="linenos"> 90</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">playerInput</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">cQuitInput</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 91</span><span class="w">                </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Goodbye!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="linenos"> 92</span><span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="linenos"> 93</span><span class="w">            </span><span class="p">}</span>
<span class="linenos"> 94</span><span class="w">            </span><span class="n">logic</span><span class="p">.</span><span class="n">advance</span><span class="p">(</span><span class="n">playerInput</span><span class="p">);</span>
<span class="linenos"> 95</span><span class="w">            </span><span class="n">renderLogic</span><span class="p">(</span><span class="n">logic</span><span class="p">);</span>
<span class="linenos"> 96</span><span class="w">            </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logic</span><span class="p">.</span><span class="n">gameState</span><span class="p">();</span>
<span class="linenos"> 97</span><span class="w">        </span><span class="p">}</span>
<span class="linenos"> 98</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">GameState</span><span class="o">::</span><span class="n">PlayerWon</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 99</span><span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;You won!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="linenos">100</span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">101</span><span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;You lost!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="linenos">102</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">103</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">104</span><span class="p">};</span>
</pre></div>
</div>
</div>
<p><a class="reference download internal" download="" href="../../_downloads/8d54f1410a89397a04d92475a4df894d/Application.hpp"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">the</span> <span class="pre">updated</span> <span class="pre">Application.hpp</span></code></a></p>
<p>To read the section list, we use:</p>
<p><code class="code highlight cpp-code cpp docutils literal highlight-cpp"><span class="o">*</span><span class="n">config</span><span class="o">-&gt;</span><span class="n">getSectionListOrThrow</span><span class="p">(</span><span class="s">&quot;field.room&quot;</span><span class="p">)</span></code></p>
<p>This line checks for the key <code class="docutils literal notranslate"><span class="pre">field.room</span></code>, confirms it contains a section list, and returns it. The <code class="docutils literal notranslate"><span class="pre">*</span></code> operator dereferences the result so it can be used directly in a <code class="code highlight cpp-code cpp docutils literal highlight-cpp"><span class="k">for</span><span class="p">()</span></code> loop.</p>
<p>Here’s the key part of the loop:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">roomValue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">config</span><span class="o">-&gt;</span><span class="n">getSectionListOrThrow</span><span class="p">(</span><span class="s">&quot;field.room&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">roomRect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rectangle</span><span class="p">{</span>
<span class="w">                    </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">roomValue</span><span class="o">-&gt;</span><span class="n">getIntegerOrThrow</span><span class="p">(</span><span class="sa">u8</span><span class="s">&quot;x&quot;</span><span class="p">)),</span>
<span class="w">                    </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">roomValue</span><span class="o">-&gt;</span><span class="n">getIntegerOrThrow</span><span class="p">(</span><span class="sa">u8</span><span class="s">&quot;y&quot;</span><span class="p">)),</span>
<span class="w">                    </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">roomValue</span><span class="o">-&gt;</span><span class="n">getIntegerOrThrow</span><span class="p">(</span><span class="sa">u8</span><span class="s">&quot;width&quot;</span><span class="p">)),</span>
<span class="w">                    </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">roomValue</span><span class="o">-&gt;</span><span class="n">getIntegerOrThrow</span><span class="p">(</span><span class="sa">u8</span><span class="s">&quot;height&quot;</span><span class="p">)),</span>
<span class="w">                </span><span class="p">};</span>
<span class="w">                </span><span class="n">world</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">addRoom</span><span class="p">(</span><span class="n">roomRect</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
</pre></div>
</div>
<p>Inside the loop, we access each section’s individual values using relative paths. For instance:</p>
<p><code class="code highlight cpp-code cpp docutils literal highlight-cpp"><span class="n">roomValue</span><span class="o">-&gt;</span><span class="n">getIntegerOrThrow</span><span class="p">(</span><span class="sa">u8</span><span class="s">&quot;x&quot;</span><span class="p">)</span></code></p>
<p>This retrieves the <code class="docutils literal notranslate"><span class="pre">x</span></code> value from the room’s section. If it’s the first room in the configuration, the full path to that value would be <code class="docutils literal notranslate"><span class="pre">field.room[0].x</span></code>.</p>
</section>
<section id="compile-and-run-the-updated-game">
<h2>Compile and Run the Updated Game<a class="headerlink" href="#compile-and-run-the-updated-game" title="Link to this heading"></a></h2>
<p>Let’s compile the updated game and try out the new configurable room layout.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake<span class="w"> </span>--build<span class="w"> </span>cmake-build
<span class="gp">$ </span>./cmake-build/robot-escape/robot-escape<span class="w"> </span>configuration.elcl
</pre></div>
</div>
<pre class="erbsland-ansi-block literal-block">----------------------------==[ ROBOT ESCAPE ]==-----------------------------
Welcome to Robot Escape!
You (☻) must run to the exit (⚑) before any robot (♟) catches you.

<span class="erbsland-ansi-bright-black">░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░</span><span class="erbsland-ansi-green">┏━━━━━━━━┓</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┏━━━━━━━━┓</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>      <span class="erbsland-ansi-bright-red">♟</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┗━━━━━━┛</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>                 <span class="erbsland-ansi-bright-red">♟</span>      <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>                        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┏━━━━━━┓</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>      <span class="erbsland-ansi-bright-green">⚑</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>    <span class="erbsland-ansi-bright-yellow">☻</span>   <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>  <span class="erbsland-ansi-bright-red">♟</span>     <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┗━━━━━━━━┛</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┗━━━━━━━━┛</span><span class="erbsland-ansi-bright-black">░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
</span>
Enter your move (n/e/s/w/q=quit): n
<span class="erbsland-ansi-bright-black">░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░</span><span class="erbsland-ansi-green">┏━━━━━━━━┓</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┏━━━━━━━━┓</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>      <span class="erbsland-ansi-bright-red">∙</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┗━━━━━━┛</span>      <span class="erbsland-ansi-bright-red">♟</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>                 <span class="erbsland-ansi-bright-red">∙</span>      <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>                 <span class="erbsland-ansi-bright-red">♟</span>      <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┏━━━━━━┓</span>    <span class="erbsland-ansi-bright-yellow">☻</span>   <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>      <span class="erbsland-ansi-bright-green">⚑</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>    <span class="erbsland-ansi-bright-yellow">∙</span>   <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>  <span class="erbsland-ansi-bright-red">∙</span><span class="erbsland-ansi-bright-red">♟</span>    <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┗━━━━━━━━┛</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┗━━━━━━━━┛</span><span class="erbsland-ansi-bright-black">░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
</span>
Enter your move (n/e/s/w/q=quit): w
<span class="erbsland-ansi-bright-black">░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░</span><span class="erbsland-ansi-green">┏━━━━━━━━┓</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┏━━━━━━━━┓</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>      <span class="erbsland-ansi-bright-red">∙</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┗━━━━━━┛</span>      <span class="erbsland-ansi-bright-red">∙</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>                 <span class="erbsland-ansi-bright-red">∙</span>    <span class="erbsland-ansi-bright-red">♟</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>                 <span class="erbsland-ansi-bright-red">∙</span><span class="erbsland-ansi-bright-red">♟</span>     <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┏━━━━━━┓</span>   <span class="erbsland-ansi-bright-yellow">☻</span><span class="erbsland-ansi-bright-yellow">∙</span>   <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>   <span class="erbsland-ansi-bright-red">♟</span>  <span class="erbsland-ansi-bright-green">⚑</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>    <span class="erbsland-ansi-bright-yellow">∙</span>   <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>  <span class="erbsland-ansi-bright-red">∙∙</span>    <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┗━━━━━━━━┛</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┗━━━━━━━━┛</span><span class="erbsland-ansi-bright-black">░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
</span>
Enter your move (n/e/s/w/q=quit): w
<span class="erbsland-ansi-bright-black">░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░</span><span class="erbsland-ansi-green">┏━━━━━━━━┓</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┏━━━━━━━━┓</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>      <span class="erbsland-ansi-bright-red">∙</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┗━━━━━━┛</span>      <span class="erbsland-ansi-bright-red">∙</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>                 <span class="erbsland-ansi-bright-red">∙</span>   <span class="erbsland-ansi-bright-red">♟</span><span class="erbsland-ansi-bright-red">∙</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>                 <span class="erbsland-ansi-bright-red">∙∙</span>     <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>   <span class="erbsland-ansi-bright-red">♟</span>    <span class="erbsland-ansi-green">┏━━━━━━┓</span>  <span class="erbsland-ansi-bright-red">♟</span><span class="erbsland-ansi-bright-yellow">∙∙</span>   <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>   <span class="erbsland-ansi-bright-red">∙</span>  <span class="erbsland-ansi-bright-green">⚑</span> <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>    <span class="erbsland-ansi-bright-yellow">∙</span>   <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┃</span>  <span class="erbsland-ansi-bright-red">∙∙</span>    <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┃</span>        <span class="erbsland-ansi-green">┃</span><span class="erbsland-ansi-bright-black">░░░
░░░</span><span class="erbsland-ansi-green">┗━━━━━━━━┛</span><span class="erbsland-ansi-bright-black">░░░░░░</span><span class="erbsland-ansi-green">┗━━━━━━━━┛</span><span class="erbsland-ansi-bright-black">░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
</span>
You lost!</pre>
<p>But maybe next time… you’ll make it! 😉</p>
</section>
<section id="recap">
<h2>Recap<a class="headerlink" href="#recap" title="Link to this heading"></a></h2>
<p>The addition of configurable rooms already makes the game more interesting and challenging. It’s now up to you to experiment—try different room shapes, sizes, and positions to create more exciting layouts!</p>
<p>That said, writing out <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">width</span></code>, and <code class="docutils literal notranslate"><span class="pre">height</span></code> for every room can get tedious. In the next section, we’ll streamline the configuration by introducing <em>value lists</em>—a much more compact and elegant way to describe the geometry of the rooms.</p>
<p class="sd-text-center"><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-success sd-fs-5 sd-font-weight-bold sd-p-2 sd-my-4 reference internal" href="09-using-value-lists.html"><span class="doc">Using Value Lists →</span></a></span></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="07-compile-and-run.html" class="btn btn-neutral float-left" title="Compile and Run Our Game" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="09-using-value-lists.html" class="btn btn-neutral float-right" title="Using Value Lists" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024-2025, Tobias Erbsland - Erbsland DEV.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>